name: Upload a GitHub release asset
description: GitHubのリリースにアセットをアップロードする。

inputs:
  release-id:
    required: true
    description: リリースの`id`。
  file:
    required: true
    description: アップロードするファイルの、シェルエスケープされたパス。

runs:
  using: composite
  steps:
    - shell: bash
      run: |
        release_id=${{ inputs.release-id }}
        file=${{ inputs.file }}
        name=$(basename "$file")

        # GitHub Docsにある、OctokitとGitHub CLIのRequest exampleは間違っているので注意。説明の本文を読むこと。
        gh api \
          "https://uploads.github.com/repos/$GITHUB_REPOSITORY/releases/$release_id/assets?name=$name" \
          --method POST \
          -H 'Accept: application/vnd.github+json' \
          -H 'X-GitHub-Api-Version: 2022-11-28' \
          --input "$file"
